# Newsroom API

## Introduction
This project is an API that generates satirical and opinionated summaries based on provided content using OpenAI's GPT-3 API. 

It may also use DeepL's API for translation if necessary. 

The goal is to have ChatGpt behave like Ricky Gervais üòé and provide sarcastic and spicy summaries üå∂Ô∏èÔ∏è

Here is an example of a summary generated by the API based on the latest EPL match between Newcastle and Tottenham ü§£:
```
Well, well, well, look who's the loser now - Tottenham Hotspurs! They had a slight bit of trouble? More like a massive, monumental meltdown resulting in a humiliating 6-1 defeat against Newcastle. Ouch!

But hey, Spurs can always take comfort in the fact that it could have been worse...I mean, I can't think of anything worse, but I'm sure it exists somewhere in an alternate universe.

Their back four experiment? What a joke! It was more like a back four disaster. The only thing that experiment proved was that playing like a bunch of headless chickens is not a winning strategy.
```

The technology stack is as follows:
- **Spring boot** as the application framework
- **PostgreSQL** as the database
- **Flyway** for database migrations
- **Gradle** as the build tool
- **Docker** for containerization
- **OpenAPI** for the API documentation and **OpenAPI Generator** for generating the server based on the OpenAPI spec
- **Testcontainers** for integration testing
- **Checkstyle** and **PMD** for static code analysis

## Commands
- `./gradlew openApiGenerate` - generates controllers and models based on the OpenAPI spec
- `./gradlew build` - builds the project
- `./gradlew bootRun` - runs the project

To run locally you will need to have a PostgreSQL database running. Just run `docker-compose up` to start the database.
Environment variables to run locally:
```bash
export SPRING_PROFILES_ACTIVE=local
export APP_DEEPL_AUTHKEY=
export APP_OPENAI_AUTHKEY=
```

## API Documentation

The API documentation can be found at [openapi.json](https://api.newsroom.alexstadnik.dev/newsroom-service/v1/openapi.json)

## Deployment

The project is deployed to my private `AWS EC2` instance. 
The deployment is done using GitHub Actions and the docker image is pushed to `AWS ECR`.
`AWS ALB` is used for load balancing and SSL termination. The subdomain is managed by `AWS Route53`.

The deployment is done automatically on every push to the `main` branch.

Deployed service:
```
https://api.newsroom.alexstadnik.dev/actuator/health
```

## Examples

Request:
```bash
curl --location --request POST 'https://api.newsroom.alexstadnik.dev/newsroom-service/api/v1/summaries' \
--header 'Content-Type: application/json' \
--data-raw '{
    "article": "Full-time: Newcastle 6-1 Tottenham.Feels odd to say that it could have been worse for Tottenham. Their back four experiment was an unmitigated disaster, and the fallout from that half could be huge. Hugo Lloris was not seen after half-time, the official word being an injury, while Harry Kane ploughed on, actually playing well. But let‚Äôs save some plaudits for Newcastle, who seized on their opponent with all guns blazing, and scored some fine goals. Their 20-year-wait for the Champions League will soon be over, with a fine response to last week‚Äôs loss to Aston Villa."
}'
```
Response:
```json
{
    "id": "344d5eec-81bd-4850-888b-4d257139cdda",
    "title": "Tottenham's Back Four Experiment: A Comedy of Errors",
    "content": "Oh, what a hilariously disastrous experiment it was! Tottenham's back four couldn't defend their way out of a paper bag, and Newcastle took full advantage with a 6-1 drubbing. Lloris disappeared mysteriously, Kane actually played well (surprise, surprise), and Tottenham's hopes for the Champions League are hanging by a thread. But let's give credit where credit's due, Newcastle played like champions and their 20-year wait is soon to be over. Absolutely brilliant.",
    "tags": [
        "Tottenham",
        "Newcastle",
        "Champions League"
    ],
    "language": "EN",
    "createdAt": "2023-04-23T18:23:31.980+00:00"
}
```
